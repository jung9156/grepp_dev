## 확률(probablity)

- 상대 도수에 의한 정의
  - 똑같은 실험을 무수히 반복할 때 어떤 일이 일어나는 비율
    - 상대도수의 극한



### 고전적 정의

- 표본공간(sample space)
  - 모든 가능한 실험결과들의 집합
  - ex.주사위의 숫자: {1, 2, 3, 4, 5, 6}
- 사건
  - 관심있는 실험결과들의 집합
  - 표본 공간이 부분집합
  - ex.주사위의 숫자 중 짝수: {2, 4, 6}
- 어떤 사건이 일어날 확률
  - 표본 공간의 모든 원소가 일어날 확률이 같은 경우
  - 사건의 원소의 수 / 표본공간의 원소의 수
- 주사위를 2번 던졌을 때 합이 10일 확률
- 표본 공간
  - 총 36개의 원소
  - ex.{(1, 1), (1, 2), ..., (6, 6)}
- 합이 10일 사건
  - {(4, 6), (5, 5), (6, 4)}
  - 확률 = 3 / 36 = 1/ 12
- A : 어떤 사건
  - A가 일어날 확률
  - P(A)
- 표본 공간의 원소의 수를 세야함
- 사건의 원소의 수를 세야함
- 따라서 경우의 수를 쉽게 셀 수 있는 방법이 필요
- 조합(combination) 사용
  - 어떤 집합에서 순서에 상관없이 뽑은 원소의 집합
  - n개 중 r개를 뽑는 조합의 수 <sub>n</sub>C<sub>r</sub> = n! / r!(n - r)!

#### 확률의 계산

- 검은공: 3개
- 흰공: 4개
- 2개의 공을 무작위로 뽑을 때, 둘 다 흰공이 나올 확률?
  - 1번부터 7번까지 7개의 공
  - <sub>4</sub>C<sub>2</sub> / <sub>7</sub>C<sub>2</sub> = 6 / 21 = 2 / 7
- 3개의 공을 무작위로 뽑을 때, 흰공 1개, 검은공 2개가 나올 확률
  - 12 / 35



#### 덧셈 법칙

- 주사위를 던지는 실험
  - 표본 공간: S = {1, 2, 3, 4, 5, 6}
- 사건 A
  - 주사위의 숫자가 짝수인 사건
  - P(A) = 1/ 2
- 사건 B
  - 주사위의 숫자가 4이상인 사건
  - P(B) = 1/ 2
- 사건 A나 사건 B가 일어날 확률
  - A U B = {2, 4, 5, 6}
  - P(A U B) = 2 / 3
- 사건 A와 사건 B가 동시에 일어날 확률
  - A 교집합 B = {4, 6}
  - P(A 교집합 B) = 1 / 3
- P(A U B) = P(A) + P(B) - P(A 교집집합 B)
  - 1 / 2 + 1 / 2 - 1 / 3 = 2 / 3



#### 서로 배반(Mutually Exclusive)

- 두 사건의 교집합이 공집합일 경우 - 사건 A와 B가 서로 배반
  - P(A 교집합 B) = 0
  - P(A U B) = P(A) + P(B)
- 사건 A
  - 주사위를 던져 홀수가 나오는 사건
- 사건 B
  - 주사위를 던져 4의 배수가 나오는 사건
- 사건 A와 사건 B는 서로 배반



#### 조건부 확률(conditional probability)

- 어떤 사건 A가 일어났을 때, 다른 사건 B가 일어날 확률
- P(B|A) = P(A 교집합 B) / P(A)
- 단, P(A) > 0
- 주사위를 하나 던졌는데, 4이상의 수가 나옴
- 이때 그 수가 짝수일 확률?
  - 사건 A
    - 4이상의 수가 나오는 사건
    - P(A) = 1 / 2
  - 사건 B
    - 짝수가 나오는 사건
  - P(A 교집합 B) = 1 / 3
- P(B|A) = P(A 교집합 B) / P(A) = (1 / 3) / (1 / 2) = 2 / 3



#### 곱셈법칙

- P(B|A) = P(A 교집합 B) / P(A)
- P(A 교집합 B) = P(B|A)p(A)



####  서로 독립

- P(B|A) = P(B)인 경우
  - 사건 A와 B는 서로 독립
- P(A 교집합 B) = P(B|A)P(A) = P(B)P(A) = P(A)P(B)



### 여사건

- 사건 A의 여사건
  - 사건 A가 일어나지 않을 사건
  - A<sup>C</sup>로 표시
- 주사위 1개를 던지는 실험
  - 사건 A
    - 주사위의 숫자가 짝수인 사건
  - 사건 A의 여사건
    - 주사위으 숫자가 짝수가 아닌(홀수인) 사건
- 어떤 사건과 그 여사건은 서로 배반
  - 둘 중 하나는 반드시 일어남
  - P(A U A<sup>C</sup>) = P(A) + P(A<sup>C</sup>) = 1
  - P(A) = 1 - P(A<sup>C</sup>)

#### 확률의 분할 법칙

- P(B) = P[(A 교집합 B) U (A<sup>C</sup> 교집합 B)] = P(A 교집합 B) + P(A<sup>C</sup> 교집합 B)
- P(B) = P(A 교집합 B) + P(A<sup>C</sup> 교집합 B) = P(B|A)P(A) + P(B|A<sup>C</sup>)P(A<sup>C</sup>)



#### 베이즈 정리

- 어떤 사건이 서로 배반하는 원인 둘에 의해 일어난다고 할 때 실제 사건이 일어났을 때 이것이 두 원인 중 하나일 확률을 구하는 정리
- 처음의 확률:
  - 사전확률(prior probability)
- 수정된 확률
  - 사후확률(posterior probability)



## 확률 분포

#### 확률 변수(random variable)

- 랜덤한 실험 결과에 의존하는 실수
  - 즉 표본 공간의 부분 집합에 대응하는 실수
- 주사위 2개를 던지는 실험
  - 주사위 숫자의 합: 하나의 확률 변수
  - 주사위 숫자의 차: 하나의 확률 변수
  - 두 주사위 숫자 중 같거나 큰 수: 하나의 확률 변수
- 동전 10개를 던지는 실험
  - 동전의 앞면의 수
  - 첫번째 앞면이 나올 때까지 던진 횟수
- 보통 표본 공간에서 실수로 대응되는 함수로 정의
- 보통 X 나 Y같은 대문자로 표시
- 이산확률변수(discrete random variable)
  - 확률변수가 취할 수 있는 모든 수 값들을 하나씩 셀 수 있는 경우
  - 주사위, 동전과 관련된 앞의 예
- 연속확률변수(continuous random variable)
  - 셀 수 없는 경우
  - 어느 학교에서 랜덤하게 선택된 남학생의 키

#### 확률 분포(probability distribution)

- 확률변수가 가질 수 있는 값에 대해 확률을 대응시켜주는 관계

- 어떤 확률 변수 X가 가질 수 있는 값: 0, 1, 3, 8

- 각 값이 나올 확률

  - P(X = 0) = 0.2
  - P(X = 1) = 0.1
  - P(X = 3) = 0.5
  - P(X = 8) = 0.2

- 표현

  - 표, 그래프, 함수 ... 등등 표현 방법은 다양함

- 주사위 2개를 던지는 실험

  - 확률 변수 x: 주사위의 합
    - x가 가질 수 있는 값: 2 ~ 12
    - 합이 12가 나올 확률 = 1 / 36

- 이산확률변수의 확률분포

  - 보통 함수로 주어짐
  - 확률변수 X가 x라는 값을 가질 확률
    - P(X = x) = f(x)
    - 확률질량함수

- 이산확률변수의 평균

  - 기대값(expected value)라고도 함
  - E(X) = 모든 변수가 나올 확률의 합

- ex.100,000번의 실험을 했다면,

  - 0이 대략적으로 10,000번
  - 2가 대략적으로 30,000번
  - 5가 대략적으로 60,000번
  - 의 평균은 (0 x 10,000 + 2 x 30,000 + 5 x 60,000) / 100,000 = 0 x 0.1 + 2 x 0.3 + 5 x 0.6 = 3.6

- 이산확률변수의 분산

  - 실험을 할 때마다 확률변수의 값이 달라질 수 있음.

  - 따라서 그 변동의 정도인 분산을 계산할 수 있음.

  - (X - u)<sup>2</sup>의 평균(u = E(X))

  - 간편식

    - ##### σ<sup>2</sup> = E(X<sup>2</sup>) - {E(X)}<sup>2</sup>

#### 결합확률 분포(joint probability distribution)

- 두 개 이상의 확률 변수가 동시에 취하는 값들에 대해 확률을 대응시켜주는 관계
- 확률변수 X
  - 한 학생이 가지는 휴대폰의 수
- 확률변수 Y
  - 한 학생이 가지느 ㄴ노트북의 수
- 결합확률분포를 통해 각 확률변수의 확률분포를 도출 할 수 있음
  - 주변확률분포(margibal probability distribution)

#### 공분산(Covariance)

- 고등학교 1학년 학생들

  - 확률변수 X : 키
  - 확률변수 Y : 몸무게
  - 확률변수 Z : 수학성적
  - (X - ux)(Y - uy) : 양일 가능성 높음(일반적으로 키와 몸무게 비례)
  - (X - ux)(z - uz) : 두 확률변수 X와 Z는 상관관계가 없기 때문에 확률 반반
  - (X - ux)(Y - uy)와 (X - ux)(z - uz)
    - 각각 확률변수
    - 따라서 평균과 분산을 구할 수 있음

- 확률변수 X와 Y의 공분산

  - (X - ux)(Y - uy)의 평균

    - ##### Cov(X, Y) = E[(X - ux)(Y - uy)] = E(XY) - uxuy = `E[XY] - E[X]E[Y]`

- 공분산은 각 확률 변수의 절대적인 크기에 영향을 받음

  - 단위에 의한 영향을 없앨 필요



- #### 상관계수(correlation coefficient)

  - ρ = Corr(X, Y) = Cov(X, Y) / ρ<sub>X</sub>ρ<sub>Y</sub> = (X, Y의 공분산) / (X의표준편차)(Y의표준편차)
  - -> 변수의 값이 클 경우, 공분산도 커지지만, 표준편차도 커지기 때문에 상쇄 가능

##### 공분산과 상관계수 모두 두 확률변수의 관계(비례하는가)를 알 수 있음



## 몇 가지 확률분포

#### 이항분포

- 베르누이 시행(Bernoulli trial)
  - 정확하게 2개의 결과만을 가지는 실험
    - ex.동전 던지기
  - 보통 성공과 실패로 결과를 구분
  - 성공의 확률: p
- 확률변수 X
  - n번의 베르누이 시행에서 성공의 횟수
  - 이항확률변수라고 함
- 이항분포(binomial distribution)
  - 이항확률변수의 확률분포
- 평균
  - E(X) = np
- 분산
  - Var(X) = np(1 - p)
- 표준편차
  - SD(X) = (np(1-p))<sup>0.5</sup>

#### 정규분포

- 연속확률변수의 확률분포

  - 확률밀도함수(probability density function)
    - f(x)
  - sP[a <= X <= b] = ∫<sub>a</sub><sup>b</sup> f(x)dx
  - 즉 그래프 아래 부분의 넓이가 확률

- 정규분포의 확률밀도함수

  - 평균과 표준편차가 주어졌을 때의 확률분포

- ##### 표준정규확률변수

  - Z = (X - μ) / σ

- 표준정규분포

  - P[Z <= z]

#### 정규분포

- ex. X~N(4, 3<sup>2</sup>)

- P[X <= 4] = ?
- 표준정규확률변수 Z = (X - μ) / σ 활용
- P[(X - μ) / σ <= (4 - μ) / σ] = P[Z <= (4 - 4) / 3] = `P[Z <= 0]`
- 표준정규분포 표에서 P[Z <= 0] = 0.5 확인 가능



- ex. X~N(4, 3<sup>2</sup>)
- P[4 <= X <= 7] = ?
- p[4 <= X <= 7] = P[x <= 7] - P[x < 4] = P[z <= 1] - P[Z < 0] = 0.8413 - 0.5 = 0.3413



#### 포아송 분포(poisson distribution)

- 일정한 시간단위 또는 공간 단위에서 발생하는 이벤트의 수의 확률분포
  - 하루동안 어떤 웹사이트를 방문하는 방문자의 수
  - 어떤 미용실에 한 시간동안 방문하는 손님의 수
  - 어떤 전기선 100미터당 발생하는 결함의 수
- 확률분포함수(확률질량함수)
  - P[X = x] = f(x), ![{\displaystyle f(n;\lambda )={\frac {\lambda ^{n}e^{-\lambda }}{n!}},\,\!}](https://wikimedia.org/api/rest_v1/media/math/render/svg/93ad8e91a5a4611aeac25ad18a63acb1ba2a7a3d)
  - 평균 : λ
  - 분산  : λ 

- ex. 어느 웹사이트에 시간당 접속자 수는 평균이 3인 포아송 분포를 따른다고 한다.
- 앞으로 1시간동안 접속자 수가 2명 이하일 확률은?
- 위의 확률분포함수에 λ = 3, n = 0, 1, 2를 대입 후 합한다.
  - 2명 이하일 확률은, 0명일 확률 + 1명일 확률 + 2명일 확률

#### 지수분포(exponential distribution)

- 포아송 분포에 의해 어떤 사건이 발생할 때, 어느 한 시점으로부터 이 사건이 발생할 때까지 걸리는 시간에 대한 확률 분포
- 확률밀도 함수
  - F(t) = λe<sup>-λt</sup>
  - λ : 포아송분포의 평균
- 평균
  - E(T) = 1 / λ
- 분산
  - Var(T) = 1 / λ<sup>2</sup>
- ex. 어느 웹사이트에 시간당 접속자 수는 λ = 3인 포아송 분포를 따른다고 한다.
- 지금부터 시작하여 첫 번째 접속자가 30분 이내에 올 확률은?
- P[T <= 0.5] = ?